/* Variables, arrays, etc. */
/* array of words for the guessing game */
const wordsList = ["pneumonia",
    "diphtheria",
    "leprosy",
    "rabies",
    "listeria",
    "ebola",
    "meningitis",
    "hepatitis",
    "measles",
    "smallpox",
    "pertussis",
    "mumps",
    "influenza",
    "chickenpox",
    "rubella",
    "malaria",
    "typhus",
    "tuberculosis"
];
var selectedWord = "";
var keyPressed = "";
var answerArr = [];
var playerGuesses = [];
var guessesLeft = 10;
var remainingLetters;
var lossCountInt = 0;
var winCountInt = 0;
// is the first time the user has guessed a letter
var firstTime = true;
var isInWord = false;

$('#start').on('click', function(event) {
    event.preventDefault();
    startGame();
});

$('#end').on('click', function(event) {
    event.preventDefault();
    endGame();
});

$(document).keyup(function() {
    //document.addEventListener("keyup", function(event) {
    // document.removeEventListener("keyup", listener, useCapture)
    keyPressed = String.fromCharCode(event.keyCode).toLowerCase();
    console.log(keyPressed);
    if (event.keyCode >= 65 && event.keyCode <= 90) {
        keyPressed = event.key;
        $("#letter").text(keyPressed);
        noDuplicateGuesses(keyPressed)
        evaluateGuess(keyPressed);
    } else {
        console.log("not a char we want");
        event.preventDefault();
    }
});

function startGame() {
    $("#status").text("Please type a letter");
    firstTime = true;
    selectWord();
}

function endGame() {
    //resetAllVars()
    $("#status").text("Good Bye");
}

function selectWord() {
    selectedWord = wordsList[Math.floor(Math.random() * wordsList.length) + 1];
    $("#wordselect").text(selectedWord);
    for (var i = 0; i < selectedWord.length; i++) {
        answerArr[i] = "_";
    }
    $("#puzzle").text(answerArr.join(" , "));
    remainingLetters = selectedWord.length;
    console.log(remainingLetters);
}

function evaluateGuess(keyPressed) {
    guessesLeft--;
    for (var i = 0; i < selectedWord.length; i++) {
        console.log("ln81-letter: " + selectedWord[i] + " index: " + i);
        if (selectedWord[i] === keyPressed) {
            answerArr[i] = selectedWord[i];
            $("#puzzle").text(answerArr);
            remainingLetters--;
            console.log("Guesses: " + guessesLeft);
            console.log("ltrsLeft: " + remainingLetters);
        }
        console.log("Guesses: " + guessesLeft);
        console.log("ltrsLeft: " + remainingLetters);
    }
    console.log(playerGuesses);
    playerGuesses.push(keyPressed);
    $("#lettersguessed").text(playerGuesses);
}

function noDuplicateGuesses(keyPressed) {
    var noDupeArray = [];
    console.log(noDupeArray);
    if (noDupeArray === undefined) {
        console.log("First Time");
        noDupeArray.push(keyPressed);
        console.log(noDupeArray);
    } else {
        for (let j = 0; j <= noDupeArray.length; j++) {
            if (noDupeArray[j] === keyPressed) {
                console.log("Duplicate");
                $("#status").text("Duplicate guess. Please choose another letter");
                break;
            }
        }
        noDupeArray.push(keyPressed);
        console.log(noDupeArray);
    }
}

function thingstoreset() {
    noDupeArray;

}